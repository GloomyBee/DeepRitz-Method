# çƒ­ä¼ å¯¼ç¤ºä¾‹ - å¿«é€Ÿå…¥é—¨æŒ‡å—

## ğŸ“ å·²åˆ›å»ºçš„æ–‡ä»¶

```
examples/heat_conduction/
â”œâ”€â”€ heat_pde.py              âœ… HeatPDEç±»ï¼ˆç»§æ‰¿BasePDEï¼‰
â”œâ”€â”€ trapezoid_sampler.py     âœ… æ¢¯å½¢åŒºåŸŸé‡‡æ ·å™¨
â”œâ”€â”€ heat_trainer.py          âœ… è®­ç»ƒå™¨ï¼ˆç»§æ‰¿BaseTrainerï¼‰
â”œâ”€â”€ heat_config.yaml         âœ… é…ç½®æ–‡ä»¶
â”œâ”€â”€ train_heat.py            âœ… è®­ç»ƒè„šæœ¬
â”œâ”€â”€ visualize_heat.py        âœ… å¯è§†åŒ–è„šæœ¬
â”œâ”€â”€ README.md                âœ… è¯¦ç»†æ–‡æ¡£
â””â”€â”€ QUICKSTART.md            âœ… æœ¬æ–‡æ¡£
```

## ğŸš€ ä½¿ç”¨æ­¥éª¤

### 1. æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ

```bash
# Linux/Mac
source venv_linux/bin/activate

# Windows
venv_linux\Scripts\activate
```

### 2. ç¡®ä¿ä¾èµ–å·²å®‰è£…

```bash
pip install torch numpy matplotlib pyyaml
```

### 3. è¿è¡Œè®­ç»ƒ

```bash
cd examples/heat_conduction
python train_heat_hr.py
```

é¢„æœŸè¾“å‡ºï¼š
```
================================================================================
çƒ­ä¼ å¯¼é—®é¢˜è®­ç»ƒ - ä½¿ç”¨DeepRitzæ¡†æ¶
================================================================================

é…ç½®å‚æ•°:
  å¯¼çƒ­ç³»æ•° k: 20.0 W/(mÂ·K)
  ä½“ç§¯çƒ­æº s: 50.0 W/mÂ³
  ...

ä½¿ç”¨è®¾å¤‡: cuda

ç½‘ç»œç»“æ„:
  æ€»å‚æ•°é‡: 12,851

================================================================================
å¼€å§‹è®­ç»ƒçƒ­ä¼ å¯¼é—®é¢˜
================================================================================
Step 0/5000: Loss = 1234.567890, LR = 0.001000, Time = 0.1s
...
è®­ç»ƒå®Œæˆï¼æ€»è€—æ—¶: 120.5ç§’
æœ€ç»ˆæŸå¤±: 0.123456

å¹³å‡PDEæ®‹å·®: 0.045678
æ¨¡å‹å·²ä¿å­˜åˆ°: ../../output/heat_model.pt
```

### 4. å¯è§†åŒ–ç»“æœ

```bash
python visualize_heat.py
```

å°†ç”Ÿæˆ `../../output/heat_results.png`ï¼ŒåŒ…å«6ä¸ªå­å›¾ï¼š
1. æ¸©åº¦åˆ†å¸ƒäº‘å›¾ï¼ˆå¸¦è¾¹ç•Œæ¡ä»¶æ ‡æ³¨ï¼‰
2. è®­ç»ƒæŸå¤±æ›²çº¿
3. æ¸©åº¦ç­‰å€¼çº¿å›¾
4. æ¸©åº¦ç»Ÿè®¡ç›´æ–¹å›¾
5. xæ–¹å‘æ¸©åº¦å‰–é¢
6. yæ–¹å‘æ¸©åº¦å‰–é¢

## ğŸ¯ æ¡†æ¶ä½¿ç”¨äº®ç‚¹

### 1. æ­£ç¡®ç»§æ‰¿åŸºç±»

```python
# âœ… æ­£ç¡®åšæ³•
from core.pdes.base_pde import BasePDE

class HeatPDE(BasePDE):
    def source_term(self, data):
        return (self.s / self.k) * torch.ones(...)

    def exact_solution(self, data):
        return None  # æ— è§£æè§£

    def boundary_condition(self, data):
        return self.T_left * torch.ones(...)
```

### 2. ä½¿ç”¨æ¡†æ¶æ¨¡å‹

```python
# âœ… ä½¿ç”¨æ¡†æ¶çš„EnhancedRitzNetï¼ˆæ­£ç¡®çš„æ¥å£ï¼‰
from core.models.mlp import EnhancedRitzNet

# å‡†å¤‡å‚æ•°å­—å…¸
model_params = {
    'd': 2,          # è¾“å…¥ç»´åº¦
    'dd': 1,         # è¾“å‡ºç»´åº¦
    'width': 50,     # éšè—å±‚å®½åº¦
    'depth': 4,      # ç½‘ç»œæ·±åº¦
    'device': device
}

# ç”Ÿæˆæ ¸å‡½æ•°èŠ‚ç‚¹
nodes = ...  # åœ¨æ¢¯å½¢åŒºåŸŸå†…çš„èŠ‚ç‚¹
s = torch.tensor(0.5)  # æ ¸å‡½æ•°å‚æ•°

# åˆ›å»ºæ¨¡å‹
model = EnhancedRitzNet(model_params, nodes, s)
model.pde = pde  # é™„åŠ PDEå®ä¾‹
```

### 3. ç»§æ‰¿è®­ç»ƒå™¨åŸºç±»

```python
# âœ… ç»§æ‰¿BaseTrainer
from core.trainer.base_trainer import BaseTrainer

class HeatTrainer(BaseTrainer):
    def _compute_loss(self, ...):
        # å®ç°çƒ­ä¼ å¯¼ä¸“ç”¨æŸå¤±
        energy_loss = ...
        bc_left_loss = ...
        bc_top_loss = ...
        return energy_loss + bc_left_loss + bc_top_loss
```

### 4. ä½¿ç”¨YAMLé…ç½®

```yaml
# heat_config.yaml
problem:
  k: 20.0
  s: 50.0

network:
  hidden_width: 50
  depth: 4

training:
  train_steps: 5000
  lr: 0.001
```

## ğŸ”§ è°ƒè¯•æŠ€å·§

### æµ‹è¯•å•ä¸ªç»„ä»¶

```bash
# æµ‹è¯•PDEæ¥å£
python heat_pde.py

# æµ‹è¯•é‡‡æ ·å™¨ï¼ˆä¼šç”Ÿæˆå¯è§†åŒ–ï¼‰
python trapezoid_sampler_hr.py
```

### ä¿®æ”¹é…ç½®å‚æ•°

ç¼–è¾‘ `heat_config.yaml`ï¼š

```yaml
# å¿«é€Ÿæµ‹è¯•ï¼ˆå‡å°‘è®­ç»ƒæ­¥æ•°ï¼‰
training:
  train_steps: 1000

# æé«˜ç²¾åº¦ï¼ˆå¢åŠ ç½‘ç»œå®¹é‡ï¼‰
network:
  hidden_width: 100
  depth: 6

# ä½¿ç”¨CPUï¼ˆå¦‚æœæ²¡æœ‰GPUï¼‰
device: "cpu"
```

## ğŸ“Š é¢„æœŸç»“æœ

### æ¸©åº¦åˆ†å¸ƒç‰¹å¾
- å·¦è¾¹ç•Œï¼šçº¦20Â°Cï¼ˆDirichlet BCï¼‰
- ä¸Šè¾¹ç•Œï¼šçƒ­æµæµå‡ºï¼Œæ¸©åº¦è¾ƒé«˜
- å†…éƒ¨ï¼šç”±äºçƒ­æºï¼Œæ¸©åº¦é«˜äºè¾¹ç•Œ
- æ¸©åº¦èŒƒå›´ï¼šçº¦20-60Â°C

### è®­ç»ƒæŒ‡æ ‡
- æœ€ç»ˆæŸå¤±ï¼š< 1.0
- PDEæ®‹å·®ï¼š< 0.1
- è®­ç»ƒæ—¶é—´ï¼š2-5åˆ†é’Ÿï¼ˆGPUï¼‰/ 10-20åˆ†é’Ÿï¼ˆCPUï¼‰

## âš ï¸ å¸¸è§é—®é¢˜

### é—®é¢˜1ï¼šModuleNotFoundError: No module named 'torch'

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# ç¡®ä¿æ¿€æ´»äº†è™šæ‹Ÿç¯å¢ƒ
source venv_linux/bin/activate  # Linux/Mac
# æˆ–
venv_linux\Scripts\activate     # Windows

# å®‰è£…ä¾èµ–
pip install torch numpy matplotlib pyyaml
```

### é—®é¢˜2ï¼šCUDA out of memory

**è§£å†³æ–¹æ¡ˆï¼š**
åœ¨ `heat_config.yaml` ä¸­å‡å°æ‰¹å¤§å°ï¼š
```yaml
sampling:
  bodyBatch: 2000   # ä»5000å‡å°
  bdryBatch: 500    # ä»1000å‡å°
```

### é—®é¢˜3ï¼šè®­ç»ƒä¸æ”¶æ•›

**è§£å†³æ–¹æ¡ˆï¼š**
1. å¢å¤§è¾¹ç•Œæƒ©ç½šç³»æ•°ï¼š`penalty: 1000`
2. å‡å°å­¦ä¹ ç‡ï¼š`lr: 0.0005`
3. å¢åŠ è®­ç»ƒæ­¥æ•°ï¼š`train_steps: 10000`

## ğŸ“š ä¸åŸå§‹heat.pyçš„å¯¹æ¯”

| ç‰¹æ€§ | åŸå§‹heat.py | æ¡†æ¶ç‰ˆæœ¬ |
|------|------------|---------|
| PDEå®šä¹‰ | ç‹¬ç«‹ç±» | âœ… ç»§æ‰¿BasePDE |
| ç½‘ç»œæ¨¡å‹ | è‡ªå®šä¹‰ResNet | âœ… ä½¿ç”¨EnhancedRitzNet |
| è®­ç»ƒå™¨ | train()å‡½æ•° | âœ… ç»§æ‰¿BaseTrainer |
| é…ç½®ç®¡ç† | ç¡¬ç¼–ç  | âœ… YAMLé…ç½®æ–‡ä»¶ |
| é‡‡æ ·å™¨ | ç‹¬ç«‹å®ç° | âœ… æ¨¡å—åŒ–é‡‡æ ·å™¨ |
| è¯¯å·®è¯„ä¼° | æ—  | âœ… PDEæ®‹å·®è¯„ä¼° |
| ä»£ç å¤ç”¨ | ä½ | âœ… é«˜ï¼ˆç»§æ‰¿æ¡†æ¶ï¼‰ |
| å¯æ‰©å±•æ€§ | ä½ | âœ… é«˜ï¼ˆæ˜“äºæ‰©å±•ï¼‰ |

## ğŸ“ å­¦ä¹ è¦ç‚¹

é€šè¿‡è¿™ä¸ªç¤ºä¾‹ï¼Œä½ å­¦ä¼šäº†ï¼š

1. âœ… å¦‚ä½•ç»§æ‰¿`BasePDE`å®šä¹‰æ–°çš„PDEé—®é¢˜
2. âœ… å¦‚ä½•å¤„ç†æ— è§£æè§£çš„é—®é¢˜ï¼ˆè¿”å›Noneï¼‰
3. âœ… å¦‚ä½•å®ç°å¤æ‚è¾¹ç•Œæ¡ä»¶ï¼ˆDirichlet + Neumannï¼‰
4. âœ… å¦‚ä½•æ‰©å±•é‡‡æ ·å™¨æ”¯æŒéæ ‡å‡†åŒºåŸŸ
5. âœ… å¦‚ä½•ç»§æ‰¿`BaseTrainer`å®ç°ä¸“ç”¨è®­ç»ƒé€»è¾‘
6. âœ… å¦‚ä½•ä½¿ç”¨YAMLé…ç½®æ–‡ä»¶ç®¡ç†å‚æ•°
7. âœ… å¦‚ä½•è¯„ä¼°æ— è§£æè§£é—®é¢˜çš„æ”¶æ•›æ€§ï¼ˆPDEæ®‹å·®ï¼‰

## ğŸš€ ä¸‹ä¸€æ­¥

1. å°è¯•ä¿®æ”¹ç‰©ç†å‚æ•°ï¼ˆk, s, T_left, q_topï¼‰
2. å°è¯•ä¸åŒçš„ç½‘ç»œç»“æ„ï¼ˆwidth, depthï¼‰
3. å®ç°å…¶ä»–å‡ ä½•åŒºåŸŸï¼ˆåœ†å½¢ã€Lå‹ç­‰ï¼‰
4. æ·»åŠ æ›´å¤šè¾¹ç•Œæ¡ä»¶ç±»å‹
5. æ‰©å±•åˆ°ç¬æ€çƒ­ä¼ å¯¼é—®é¢˜

## ğŸ“ è·å–å¸®åŠ©

- æŸ¥çœ‹ `README.md` è·å–è¯¦ç»†æ–‡æ¡£
- æŸ¥çœ‹æ¡†æ¶æ–‡æ¡£äº†è§£åŸºç±»æ¥å£
- å‚è€ƒ `core/pdes/poisson.py` äº†è§£PDEå®ç°ç¤ºä¾‹
- å‚è€ƒ `core/trainer/trainer.py` äº†è§£è®­ç»ƒå™¨å®ç°ç¤ºä¾‹
